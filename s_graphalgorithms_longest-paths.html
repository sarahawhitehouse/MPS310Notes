<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<!--******************************************-->
<!--*  Authored with PreTeXt                 *-->
<!--*  pretextbook.org                       *-->
<!--*  Theme: default-modern                 *-->
<!--*  Palette:                              *-->
<!--******************************************-->
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Algorithm for Longest Paths</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="MPS310: Graph Theory">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.11.8';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.991c135ccf182bf5.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.1c010553c35c544c.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.677a75a9120449ff.css">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script src="_static/pretext/js/lti_iframe_resizer.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script>
</head>
<body class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="MPS310.html"><span class="title">MPS310: Graph Theory</span></a></h1>
<p class="byline"></p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="s_graphalgorithms_shortest-paths.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch_algorithms.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="s_graphalgorithms_traveling-salesperson.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\set}[1]{\{1,2,\dotsc,#1\,\}}
    \newcommand{\ints}{\mathbb{Z}}
    \newcommand{\posints}{\mathbb{N}}
    \newcommand{\rats}{\mathbb{Q}}
    \newcommand{\reals}{\mathbb{R}}
    \newcommand{\complexes}{\mathbb{C}}
    \newcommand{\twospace}{\mathbb{R}^2}
    \newcommand{\threepace}{\mathbb{R}^3}
    \newcommand{\dspace}{\mathbb{R}^d}
    \newcommand{\nni}{\mathbb{N}_0}
    \newcommand{\nonnegints}{\mathbb{N}_0}
    \newcommand{\dom}{\operatorname{dom}}
    \newcommand{\ran}{\operatorname{ran}}
    \newcommand{\prob}{\operatorname{prob}}
    \newcommand{\Prob}{\operatorname{Prob}}
    \newcommand{\height}{\operatorname{height}}
    \newcommand{\width}{\operatorname{width}}
    \newcommand{\length}{\operatorname{length}}
    \newcommand{\crit}{\operatorname{crit}}
    \newcommand{\inc}{\operatorname{inc}}
    \newcommand{\HP}{\mathbf{H_P}}
    \newcommand{\HCP}{\mathbf{H^c_P}}
    \newcommand{\GP}{\mathbf{G_P}}
    \newcommand{\GQ}{\mathbf{G_Q}}
    \newcommand{\AG}{\mathbf{A_G}}
    \newcommand{\GCP}{\mathbf{G^c_P}}
    \newcommand{\PXP}{\mathbf{P}=(X,P)}
    \newcommand{\QYQ}{\mathbf{Q}=(Y,Q)}
    \newcommand{\GVE}{\mathbf{G}=(V,E)}
    \newcommand{\HWF}{\mathbf{H}=(W,F)}
    \newcommand{\bfC}{\mathbf{C}}
    \newcommand{\bfG}{\mathbf{G}}
    \newcommand{\bfH}{\mathbf{H}}
    \newcommand{\bfF}{\mathbf{F}}
    \newcommand{\bfI}{\mathbf{I}}
    \newcommand{\bfK}{\mathbf{K}}
    \newcommand{\bfP}{\mathbf{P}}
    \newcommand{\bfQ}{\mathbf{Q}}
    \newcommand{\bfR}{\mathbf{R}}
    \newcommand{\bfS}{\mathbf{S}}
    \newcommand{\bfT}{\mathbf{T}}
    \newcommand{\bfNP}{\mathbf{NP}}
    \newcommand{\bftwo}{\mathbf{2}}
    \newcommand{\cgA}{\mathcal{A}}
    \newcommand{\cgB}{\mathcal{B}}
    \newcommand{\cgC}{\mathcal{C}}
    \newcommand{\cgD}{\mathcal{D}}
    \newcommand{\cgE}{\mathcal{E}}
    \newcommand{\cgF}{\mathcal{F}}
    \newcommand{\cgG}{\mathcal{G}}
    \newcommand{\cgM}{\mathcal{M}}
    \newcommand{\cgN}{\mathcal{N}}
    \newcommand{\cgP}{\mathcal{P}}
    \newcommand{\cgR}{\mathcal{R}}
    \newcommand{\cgS}{\mathcal{S}}
    \newcommand{\bfn}{\mathbf{n}}
    \newcommand{\bfm}{\mathbf{m}}
    \newcommand{\bfk}{\mathbf{k}}
    \newcommand{\bfs}{\mathbf{s}}
    \newcommand{\bijection}{\xrightarrow[\text{onto}]{\text{$1$--$1$}}}
    \newcommand{\injection}{\xrightarrow[]{\text{$1$--$1$}}}
    \newcommand{\surjection}{\xrightarrow[\text{onto}]{}}
    \newcommand{\nin}{\not\in}
    \newcommand{\prufer}{\mbox{prÃ¼fer}}
    \DeclareMathOperator{\fix}{fix}
    \DeclareMathOperator{\stab}{stab}
    \DeclareMathOperator{\var}{var}
    \newcommand{\inv}{^{-1}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="MPS310-2.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch_intro.html" class="internal"><span class="codenumber">1</span> <span class="title">Introduction</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_intro_firstlook.html" class="internal"><span class="codenumber">1.1</span> <span class="title">A first look at graphs</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_firstlook.html#s_intro_firstlook-2" class="internal"><span class="codenumber">1.1.1</span> <span class="title">The idea of a graph</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_firstlook.html#s_intro_firstlook-3" class="internal"><span class="codenumber">1.1.2</span> <span class="title">The formal definition of a graph</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_firstlook.html#s_intro_firstlook-4" class="internal"><span class="codenumber">1.1.3</span> <span class="title">Basic examples and concepts</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_intro_degrees.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Degree and handshaking</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_degrees.html#s_intro_degrees-2" class="internal"><span class="codenumber">1.2.1</span> <span class="title">Definition of degree</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_degrees.html#s_intro_degrees-3" class="internal"><span class="codenumber">1.2.2</span> <span class="title">Extended example: Chemistry</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_degrees.html#s_intro_degrees-4" class="internal"><span class="codenumber">1.2.3</span> <span class="title">Handshaking lemma and first applications</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_intro_isomorphisms.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Graph Isomorphisms</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_isomorphisms.html#s_intro_isomorphisms-3" class="internal"><span class="codenumber">1.3.1</span> <span class="title">Isomorphic graphs</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_isomorphisms.html#s_intro_isomorphisms-4" class="internal"><span class="codenumber">1.3.2</span> <span class="title">Heuristics for showing graphs are or arenâ€™t isomorphic</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_isomorphisms.html#s_intro_isomorphisms-5" class="internal"><span class="codenumber">1.3.3</span> <span class="title">Cultural Literacy: The Graph Isomorphism Problem</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_intro_instantinsanity.html" class="internal"><span class="codenumber">1.4</span> <span class="title">Instant Insanity</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_instantinsanity.html#s_intro_instantinsanity-3" class="internal"><span class="codenumber">1.4.1</span> <span class="title">A puzzle</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_instantinsanity.html#s_intro_instantinsanity-4" class="internal"><span class="codenumber">1.4.2</span> <span class="title">Enter graph theory</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_instantinsanity.html#s_intro_instantinsanity-5" class="internal"><span class="codenumber">1.4.3</span> <span class="title">Proving that our cubes were impossible</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_instantinsanity.html#s_intro_instantinsanity-6" class="internal"><span class="codenumber">1.4.4</span> <span class="title">Other cube sets</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_intro_trees.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Trees</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_trees.html#s_intro_trees-3" class="internal"><span class="codenumber">1.5.1</span> <span class="title">Basics on trees</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_trees.html#s_intro_trees-4" class="internal"><span class="codenumber">1.5.2</span> <span class="title">Leaves</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_intro_trees.html#s_intro_trees-5" class="internal"><span class="codenumber">1.5.3</span> <span class="title">Trees in Chemistry</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="s_intro_exercises.html" class="internal"><span class="codenumber">1.6</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch_walks.html" class="internal"><span class="codenumber">2</span> <span class="title">Walks</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_walks_basics.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Walks: the basics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_walks_basics.html#s_walks_basics-3" class="internal"><span class="codenumber">2.1.1</span> <span class="title">Walks and connectedness</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_walks_basics.html#s_walks_basics-4" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Types of Walks</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_walks_eulerian.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Eulerian Walks</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_walks_eulerian.html#s_walks_eulerian-3" class="internal"><span class="codenumber">2.2.1</span> <span class="title">The bridges of Konigsburg</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_walks_eulerian.html#s_walks_eulerian-4" class="internal"><span class="codenumber">2.2.2</span> <span class="title">Eulerian Walks: definitions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_walks_eulerian.html#s_walks_eulerian-5" class="internal"><span class="codenumber">2.2.3</span> <span class="title">A digression on proofs, formality, and intuition</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="s_walks_hamiltonian.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Hamiltonian cycles</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="s_walks_exercises.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch_algorithms.html" class="internal"><span class="codenumber">3</span> <span class="title">Algorithms</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="s_graphalgorithms_prufer.html" class="internal"><span class="codenumber">3.1</span> <span class="title">PrÃ¼fer Codes</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_graphalgorithms_min-wt-span.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Minimum Weight Spanning Trees</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphalgorithms_min-wt-span.html#s_graphalgorithms_min-wt-span-3" class="internal"><span class="codenumber">3.2.1</span> <span class="title">Preliminaries</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphalgorithms_min-wt-span.html#s_graphalgorithms_min-wt-span-4" class="internal"><span class="codenumber">3.2.2</span> <span class="title">Kruskalâ€™s Algorithm</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphalgorithms_min-wt-span.html#alg_prim" class="internal"><span class="codenumber">3.2.3</span> <span class="title">Primâ€™s Algorithm</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphalgorithms_min-wt-span.html#s_graphalgorithms_min-wt-span-6" class="internal"><span class="codenumber">3.2.4</span> <span class="title">Comments on Efficiency</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="s_graphalgorithms_digraphs.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Digraphs</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_graphalgorithms_shortest-paths.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Dijkstraâ€™s Algorithm for Shortest Paths</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphalgorithms_shortest-paths.html#s_graphalgorithms_shortest-paths-3" class="internal"><span class="codenumber">3.4.1</span> <span class="title">Description of the Algorithm</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphalgorithms_shortest-paths.html#s_graphalgorithms_shortest-paths-4" class="internal"><span class="codenumber">3.4.2</span> <span class="title">Example of Dijkstraâ€™s Algorithm</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphalgorithms_shortest-paths.html#s_graphalgorithms_shortest-paths-5" class="internal"><span class="codenumber">3.4.3</span> <span class="title">The Correctness of Dijkstraâ€™s Algorithm</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="s_graphalgorithms_longest-paths.html" class="internal"><span class="codenumber">3.5</span> <span class="title">Algorithm for Longest Paths</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="s_graphalgorithms_longest-paths.html#subs_graphalgorithms_longest-path-motivation" class="internal"><span class="codenumber">3.5.1</span> <span class="title"></span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="s_graphalgorithms_longest-paths.html#subs_graphalgorithms_longest-path-motivation-5" class="internal"><span class="codenumber">3.5.1.1</span> <span class="title">Our running example</span></a></div></li></ul>
</li>
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="s_graphalgorithms_longest-paths.html#subs_graphalgorithms_longest-path-algorithm" class="internal"><span class="codenumber">3.5.2</span> <span class="title">Longest Path Algorithm</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="s_graphalgorithms_longest-paths.html#subs_graphalgorithms_longest-path-algorithm-3" class="internal"><span class="codenumber">3.5.2.1</span> <span class="title">Topolgical sort</span></a></div></li>
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="s_graphalgorithms_longest-paths.html#subs_graphalgorithms_longest-path-algorithm-4" class="internal"><span class="codenumber">3.5.2.2</span> <span class="title">The Algorithm</span></a></div></li>
<li class="toc-item toc-subsubsection"><div class="toc-title-box"><a href="s_graphalgorithms_longest-paths.html#subs_graphalgorithms_longest-path-algorithm-5" class="internal"><span class="codenumber">3.5.2.3</span> <span class="title">Critical path analysis</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_graphalgorithms_traveling-salesperson.html" class="internal"><span class="codenumber">3.6</span> <span class="title">The Traveling Salesperson Problem</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphalgorithms_traveling-salesperson.html#subs_graphalgorithms_tsp_intro" class="internal"><span class="codenumber">3.6.1</span> <span class="title">Introduction to the Traveling Salesperson Problem</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphalgorithms_traveling-salesperson.html#subs_graphalgorithms_tsp_upper" class="internal"><span class="codenumber">3.6.2</span> <span class="title">Finding upper bounds to the TSP</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphalgorithms_traveling-salesperson.html#subs_graphalgorithms_tsp_lower" class="internal"><span class="codenumber">3.6.3</span> <span class="title">A lower point for TSP</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="s_graphalgorithms_exercises.html" class="internal"><span class="codenumber">3.7</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch_graphs_on_surfaces.html" class="internal"><span class="codenumber">4</span> <span class="title">Graphs on Surfaces</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_graphs_on_surfaces_intro.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Introduction to Graphs on Surfaces</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_intro.html#s_graphs_on_surfaces_intro-3" class="internal"><span class="codenumber">4.1.1</span> <span class="title">The Utilities Problem</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_intro.html#s_graphs_on_surfaces_intro-4" class="internal"><span class="codenumber">4.1.2</span> <span class="title"></span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_graphs_on_surfaces_planarity_algorithm.html" class="internal"><span class="codenumber">4.2</span> <span class="title">The planarity algorithm for Hamiltonian graphs</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_planarity_algorithm.html#s_graphs_on_surfaces_planarity_algorithm-3" class="internal"><span class="codenumber">4.2.1</span> <span class="title">Stereographic Projection and Unnecessary cases</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_planarity_algorithm.html#s_graphs_on_surfaces_planarity_algorithm-4" class="internal"><span class="codenumber">4.2.2</span> <span class="title">The planarity algorithm</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_graphs_on_surfaces_Kuratowski.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Kuratowskiâ€™s Theorem</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_Kuratowski.html#s_graphs_on_surfaces_Kuratowski-3" class="internal"><span class="codenumber">4.3.1</span> <span class="title">Planarity, subgraphs, and subdivisions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_Kuratowski.html#s_graphs_on_surfaces_Kuratowski-4" class="internal"><span class="codenumber">4.3.2</span> <span class="title">Kuratowskiâ€™s Theorem</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_Kuratowski.html#s_graphs_on_surfaces_Kuratowski-5" class="internal"><span class="codenumber">4.3.3</span> <span class="title">Applying Kuratowskiâ€™s Theorem</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_graphs_on_surfaces_other_surfaces.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Drawing Graphs on Other surfaces</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_other_surfaces.html#s_graphs_on_surfaces_other_surfaces-3" class="internal"><span class="codenumber">4.4.1</span> <span class="title">Motivation and culture: Manifolds and Surfaces</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_other_surfaces.html#s_graphs_on_surfaces_other_surfaces-4" class="internal"><span class="codenumber">4.4.2</span> <span class="title">Graphs on the Torus</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_other_surfaces.html#s_graphs_on_surfaces_other_surfaces-5" class="internal"><span class="codenumber">4.4.3</span> <span class="title">MÃ¶bius strip</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_graphs_on_surfaces_euler.html" class="internal"><span class="codenumber">4.5</span> <span class="title">Eulerâ€™s Theorem</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_euler.html#s_graphs_on_surfaces_euler-3" class="internal"><span class="codenumber">4.5.1</span> <span class="title">Counting faces</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_graphs_on_surfaces_euler.html#s_graphs_on_surfaces_euler-4" class="internal"><span class="codenumber">4.5.2</span> <span class="title">Applications of Eulerâ€™s theorem</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="s_graphs_on_surfaces_exercises.html" class="internal"><span class="codenumber">4.6</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch_colourings.html" class="internal"><span class="codenumber">5</span> <span class="title">Colourings</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="s_chromatic_number.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Chromatic number</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="s_chromatic_index.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Chromatic index and applications</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_chromatic_polynomial_intro.html" class="internal"><span class="codenumber">5.3</span> <span class="title">Introduction to the chromatic polynomial</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_chromatic_polynomial_intro.html#s_chromatic_polynomial_intro-3" class="internal"><span class="codenumber">5.3.1</span> <span class="title">Definition and examples</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_chromatic_polynomial_intro.html#s_chromatic_polynomial_intro-4" class="internal"><span class="codenumber">5.3.2</span> <span class="title">Gluing</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_chromatic_polynomial_intro.html#s_chromatic_polynomial_intro-5" class="internal"><span class="codenumber">5.3.3</span> <span class="title">Case by case analysis</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="s_chromatic_polynomial_more.html" class="internal"><span class="codenumber">5.4</span> <span class="title">Chromatic Polynomial continued</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_chromatic_polynomial_more.html#s_chromatic_polynomial_more-3" class="internal"><span class="codenumber">5.4.1</span> <span class="title">Deletion-Contraction</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="s_chromatic_polynomial_more.html#s_chromatic_polynomial_more-4" class="internal"><span class="codenumber">5.4.2</span> <span class="title">Chromatic polynomial is a polynomial</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="s_chromatic_exercises.html" class="internal"><span class="codenumber">5.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="s_graphalgorithms_longest-paths"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">3.5</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title">Algorithm for Longest Paths</span>
</h2>
<section class="introduction" id="s_graphalgorithms_longest-paths-2"><div class="para" id="s_graphalgorithms_longest-paths-2-1">To complement Dijkstraâ€™s algorithm for finding the short path, in this section we give an algorithm for finding the <em class="emphasis">longest</em> path between two vertices in a directed graph.<div class="autopermalink" data-description="Paragraph"><a href="#s_graphalgorithms_longest-paths-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="s_graphalgorithms_longest-paths-2-2">It is not immediately clear why we might want to do this, so first in <a href="s_graphalgorithms_longest-paths.html#subs_graphalgorithms_longest-path-motivation" class="internal" title="Subsection 3.5.1">SubsectionÂ 3.5.1</a>   we give a motivational problem: scheduling work on a complicated project.  The algorithm we present will only work on <em class="emphasis">acyclic</em> directed graphs, so in <code class="code-inline tex2jax_ignore">[cross-reference to target(s) "subs_graphalgorithms_longest-path-acyclic-sort" missing or not unique]</code> we define these, explain why this isnâ€™t a restriction for our intended application, and give the first step of the algorithm: "topologically sorting" the vertices of an acyclic directed graph.  Finally, in <a href="s_graphalgorithms_longest-paths.html#subs_graphalgorithms_longest-path-algorithm" class="internal" title="Subsection 3.5.2: Longest Path Algorithm">SubsectionÂ 3.5.2</a>   we explain the actual algorithm.<div class="autopermalink" data-description="Paragraph"><a href="#s_graphalgorithms_longest-paths-2-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div></section><section class="subsection" id="subs_graphalgorithms_longest-path-motivation"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">3.5.1</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title"></span>
</h3>
<div class="para" id="subs_graphalgorithms_longest-path-motivation-1">The main application of the longest path algorithm is in scheduling.  Suppose we have a large project -- say, building a house -- that is composed of many smaller projects: digging the foundation, building the walls, connecting to gas, electricity, and water, building the roof, doing the interiors, landscaping, etc.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-motivation-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-motivation-2">Some of these activities will require others to be done before them (you canâ€™t put the roof on before youâ€™ve built the walls; you donâ€™t want to do the landscaping before youâ€™ve dug your water lines), while others could be done at the same time (finishing the interiors and doing the landscaping).  Each sub-job has an expected amount of time required to finish it; youâ€™d like to know before hand how long the whole task will take, and when the various sub-jobs should be done so you can arrange the contractors.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-motivation-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-motivation-3">From a series of jobs like this, we will construct a weighted, directed, acyclic graph.  The edges will be the sub-jobs. The weights of each edge will be the expected length of time that job has.  The structure of the graph will encode the dependencies of the subjobs on each other -- an edge <span class="process-math">\(e\)</span> will flow into an edge <span class="process-math">\(f\)</span> if the job <span class="process-math">\(f\)</span> immediately depends about the job <span class="process-math">\(e\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-motivation-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-motivation-4">We will work out the construction of this graph in one example.  It is not always trivial to construct the directed graph from the table of jobs and dependencies.  It is not clear what the vertices should be, and sometimes dummy edges and vertices need to be encoded.  You do not need to worry about constructing these graphs in general, though if youâ€™re curious it can be interesting to think about.  Any exam question about this topic would supply you with the directed graph.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-motivation-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<section class="subsubsection" id="subs_graphalgorithms_longest-path-motivation-5"><h4 class="heading hide-type">
<span class="type">Subsubsection</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">3.5.1.1</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title">Our running example</span>
</h4>
<div class="para" id="subs_graphalgorithms_longest-path-motivation-5-2">Consider the following table, listing tasks <span class="process-math">\(A-H\text{,}\)</span> the expected time of completion for each task, and the required tasks before a given task can be started.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-motivation-5-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<figure class="table table-like" id="subs_graphalgorithms_longest-path-motivation-5-3"><figcaption><span class="type">Table</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">3.5.1<span class="period heading-divison-mark heading-divison-mark__period">.</span></span><span class="space heading-divison-mark heading-divison-mark__space"> </span>Table showing the prerequisites for each task.<div class="autopermalink" data-description="Table 3.5.1: Table showing the prerequisites for each task."><a href="#subs_graphalgorithms_longest-path-motivation-5-3" title="Copy heading and permalink for Table 3.5.1: Table showing the prerequisites for each task." aria-label="Copy heading and permalink for Table 3.5.1: Table showing the prerequisites for each task.">ðŸ”—</a></div></figcaption><div class="tabular-box natural-width"><table class="tabular">
<tr>
<td class="l m b1 r0 l0 t0 lines">Task</td>
<td class="l m b1 r0 l0 t0 lines">Time</td>
<td class="l m b1 r0 l0 t0 lines">Prerequisites</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">A</td>
<td class="l m b0 r0 l0 t0 lines">6</td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">B</td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">C</td>
<td class="l m b0 r0 l0 t0 lines">4</td>
<td class="l m b0 r0 l0 t0 lines">A</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">D</td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines">A</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">E</td>
<td class="l m b0 r0 l0 t0 lines">4</td>
<td class="l m b0 r0 l0 t0 lines">B,D</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">F</td>
<td class="l m b0 r0 l0 t0 lines">10</td>
<td class="l m b0 r0 l0 t0 lines">C</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">G</td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines">C</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">H</td>
<td class="l m b0 r0 l0 t0 lines">10</td>
<td class="l m b0 r0 l0 t0 lines">E,G</td>
</tr>
</table></div></figure><div class="para" id="subs_graphalgorithms_longest-path-motivation-5-4">Here is the corresponding graph encoding this information:<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-motivation-5-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/tasks.png" class="contained"></div>
<div class="para" id="subs_graphalgorithms_longest-path-motivation-5-6">We outline how the graph above was constructed.  We make one vertex for the start, one vertex for the finish, and then another vertex for each set of dependencies, that is, the entries in the third column.  Then we draw an edge for each letter, beginning at the vertex corresponding to its set of prerequisites (or the start, if it has none), and ending at the vertex that contains it as a prerequisite (or the end, if no tasks require it as a prerequisite).<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-motivation-5-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-motivation-5-7">Note that this method works only if any two sets of prerequisites either have nontrivial intersection or are identical.  The tricky cases you donâ€™t have to worry about are when this isnâ€™t true.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-motivation-5-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Subsubsection 3.5.1.1: Our running example"><a href="#subs_graphalgorithms_longest-path-motivation-5" title="Copy heading and permalink for Subsubsection 3.5.1.1: Our running example" aria-label="Copy heading and permalink for Subsubsection 3.5.1.1: Our running example">ðŸ”—</a></div></section><div class="para" id="subs_graphalgorithms_longest-path-motivation-6">With that detour out of the way, we see why finding the longest path in a directed acyclic graph is useful: in case the edges are tasks and the weights are expected times, the length of the longest path is the minimal time the whole project would be able to be completed.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-motivation-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-motivation-7">Moreover, it is useful to actually know what the longest paths are -- to achieve this minimal time, each task in the longest path must be completed in the expected amount of time, and the next task in the path must be started immediately when the first one finishes.  For this reason, the longest paths are known as <em class="emphasis">critical paths</em>.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-motivation-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Subsection 3.5.1"><a href="#subs_graphalgorithms_longest-path-motivation" title="Copy heading and permalink for Subsection 3.5.1" aria-label="Copy heading and permalink for Subsection 3.5.1">ðŸ”—</a></div></section><section class="subsection" id="subs_graphalgorithms_longest-path-algorithm"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">3.5.2</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title">Longest Path Algorithm</span>
</h3>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-2">We now describe an algorithm for finding the longest paths from a starting vertex <span class="process-math">\(S\)</span> to all other vertices.  In some ways, it is similar to Dijkstraâ€™s algorithm, in that we will keep a list of "tentative longest paths found so far", and iteratively mark one of these to a vertex <span class="process-math">\(v\)</span> as an actual longest path, and then update our list with potentially new longest paths by combining our longest path to <span class="process-math">\(v\)</span> with the edges out of <span class="process-math">\(v\text{.}\)</span>  The main difference is that the ordering this updating will happen will be chosen at the beginning -- any ordering of the vertices compatible with the directed graph structure will work.  These orderings are sometimes known as a "topological sort".<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<section class="subsubsection" id="subs_graphalgorithms_longest-path-algorithm-3"><h4 class="heading hide-type">
<span class="type">Subsubsection</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">3.5.2.1</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title">Topolgical sort</span>
</h4>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-3-2">The first step of the Longest Path Algortihm is to number/list the vertices of the graph so that all edges flow from a lower vertex to a higher vertex.  Such a listing is known as a "compatible total ordering" of the vertices, or a "topological sort" of the vertices. For such a list to exist, it is necessary for the graph to be acyclic.  Otherwise, we get a "what came first, the chicken or the egg?" type situation.  For instance, if we had a directed cycle <span class="process-math">\(A\to B\to C\to A\text{,}\)</span> we couldnâ€™t choose any of <span class="process-math">\(A, B,C\)</span> to put first, as each one has an error into it from the other vertices.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-3-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-3-3">In our running example graph, the vertices are already numbered in a way compatible with the edge structure, and so is already topologically sorted: <span class="process-math">\(S,1,2,3,4,F\)</span> is an ordering satisfying the desired properties.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-3-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-3-4">It turns out that this is the only obstacle, and as long as the graph is acyclic, it will have a compatible total ordering.  It is not too hard to prove this carefully using induction, and to turn the proof into a constructive algorithm into how to do it, and we invite you to do so.  However, in practice for small graphs it is usually not hard to find total orderings.  Start with a source (a vertex with no incoming edges, only outgoing edges), then continually look for vertices that only have incoming edges from vertices already on our list.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-3-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-3-5">Finally, we should stress that the topological sort of the vertices is usually not unique.  For instance, in our running example, there is no edge between 2 and 3, so instead of <span class="process-math">\(S,1,2,3,4,F\)</span> we could have ordered the vertices as <span class="process-math">\(S,1,3,2,4,F\text{,}\)</span> and it also would have been a total ordering.  It wonâ€™t matter which total ordering you choose -- the longest path algorithm will still work.  In practice applications a valid total ordering will often be â€™obviousâ€™.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-3-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Subsubsection 3.5.2.1: Topolgical sort"><a href="#subs_graphalgorithms_longest-path-algorithm-3" title="Copy heading and permalink for Subsubsection 3.5.2.1: Topolgical sort" aria-label="Copy heading and permalink for Subsubsection 3.5.2.1: Topolgical sort">ðŸ”—</a></div></section><section class="subsubsection" id="subs_graphalgorithms_longest-path-algorithm-4"><h4 class="heading hide-type">
<span class="type">Subsubsection</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">3.5.2.2</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title">The Algorithm</span>
</h4>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-4-2">Having topologically sorted the vertices, we find the longest path to each other vertex inductively, by ordering of their numbers.  Suppose that we have found the longest paths to each vertex with number lower than <span class="process-math">\(k\text{,}\)</span> and we want to find the length of the longest path to vertex <span class="process-math">\(k\text{,}\)</span> which we will call <span class="process-math">\(u\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-4-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-4-3">Let <span class="process-math">\(e_i\)</span> be the edges that come into <span class="process-math">\(u\text{,}\)</span> let <span class="process-math">\(w(e_i)\)</span> be the lengths of these edges, and let <span class="process-math">\(v_i\)</span> be the source vertex of <span class="process-math">\(e_i\text{.}\)</span>  Since our edges go from lower numbered vertices to higher numbered vertices, all the <span class="process-math">\(v_i\)</span> are labelled with numbers lower than <span class="process-math">\(w\)</span> (i.e., lower than <span class="process-math">\(k\)</span>), and hence by the inductive hypothesis we know the longest paths to <span class="process-math">\(v_i\text{.}\)</span>   Let <span class="process-math">\(\ell(v_i)\)</span> be the length of this longest path from <span class="process-math">\(S\)</span> to <span class="process-math">\(v_i\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-4-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-4-4">Any path to <span class="process-math">\(w\)</span> must pass through one of the <span class="process-math">\(v_i\text{,}\)</span> and so the length of the longest path to <span class="process-math">\(u\)</span> is the<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-4-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="displaymath process-math" id="subs_graphalgorithms_longest-path-algorithm-4-5">
\begin{equation*}
\ell(u)=\text{max}_i \big[\ell(v_i)+w(e_i)\big]
\end{equation*}
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-4-6">Typically we will want to find the longest path in addition to just knowing its length, and an easy way to do this is to record the edges <span class="process-math">\(e_i\)</span> that achieve the maximum.  Then we can find the long paths in reverse by starting from <span class="process-math">\(F\)</span> and going to any recorded vertex.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-4-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<details id="subs_graphalgorithms_longest-path-algorithm-4-7" class="example example-like born-hidden-knowl"><summary class="knowl__link"><h5 class="heading">
<span class="type">Example</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">3.5.2</span><span class="period heading-divison-mark heading-divison-mark__period">.</span>
</h5></summary><article class="example example-like knowl__content"><div class="para" id="subs_graphalgorithms_longest-path-algorithm-4-7-1">We illustrate the longest path algorithm with our example graph.  Our start vertex is <span class="process-math">\(S\text{,}\)</span> and so <span class="process-math">\(\ell(S)=0\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-4-7-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-4-7-2">Vertex 1 has only one incoming edge: <span class="process-math">\(A\text{,}\)</span> with weight 6, and so <span class="process-math">\(\ell(1)=6+\ell(S)=6\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-4-7-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-4-7-3">Vertex 2 has two incoming edges: <span class="process-math">\(B\)</span> and <span class="process-math">\(D\text{,}\)</span> and so we see that <span class="process-math">\(\ell(2)\)</span> is the maximum of <span class="process-math">\(w(D)+\ell(1)=3+6=9\text{,}\)</span> and <span class="process-math">\(w(B)+\ell(S)=7+0=7\text{,}\)</span> and so <span class="process-math">\(\ell(2)=9\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-4-7-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-4-7-4">Vertex 3 has just one incoming edge: <span class="process-math">\(C\text{,}\)</span> and so <span class="process-math">\(\ell(3)=w(C)+\ell(1)=4+6=10\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-4-7-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-4-7-5">Vertex 4 has two incoming edges: <span class="process-math">\(G\)</span> and <span class="process-math">\(E\text{,}\)</span> and so <span class="process-math">\(\ell(4)\)</span> is the maximum of <span class="process-math">\(w(G)+\ell(3)=3+10=13\)</span> and <span class="process-math">\(w(E)+\ell(2)=4+9=13\text{.}\)</span>  Thus, the maximum is achieved in two different ways, and we see that there are two paths of length 13 from <span class="process-math">\(S\)</span> to <span class="process-math">\(4\)</span> -- <span class="process-math">\(S-1-3-4\)</span> and <span class="process-math">\(S-1-2-4\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-4-7-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-4-7-6">Finally, vertex <span class="process-math">\(F\)</span> has two incoming edges, <span class="process-math">\(F\)</span> and <span class="process-math">\(H\text{,}\)</span> and so <span class="process-math">\(\ell(F)\)</span> is the maximum of <span class="process-math">\(w(F)+\ell(3)=10+10=20\)</span> and <span class="process-math">\(w(H)+\ell(4)=10+13=23\text{.}\)</span>  There are two paths that achieve this maximum -- <span class="process-math">\(A-C-G-H\)</span> and <span class="process-math">\(A-D-E-H\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-4-7-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Example 3.5.2"><a href="#subs_graphalgorithms_longest-path-algorithm-4-7" title="Copy heading and permalink for Example 3.5.2" aria-label="Copy heading and permalink for Example 3.5.2">ðŸ”—</a></div></article></details><div class="autopermalink" data-description="Subsubsection 3.5.2.2: The Algorithm"><a href="#subs_graphalgorithms_longest-path-algorithm-4" title="Copy heading and permalink for Subsubsection 3.5.2.2: The Algorithm" aria-label="Copy heading and permalink for Subsubsection 3.5.2.2: The Algorithm">ðŸ”—</a></div></section><section class="subsubsection" id="subs_graphalgorithms_longest-path-algorithm-5"><h4 class="heading hide-type">
<span class="type">Subsubsection</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">3.5.2.3</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title">Critical path analysis</span>
</h4>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-5-2">Apart from knowing the minimum time for completion of the project, finding the longest paths is useful for analysing where to put resources.  In particular, which tasks, if they run slightly over, would make the whole project run late?  Which tasks, if they were able to finish slightly early, would make the whole project finish early?<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-5-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-5-3">To make the whole project run later, we need to increase the length of the longest path, which means we to increase the length of *any* long path.  Thus, the edges that would make the whole project run over are those contained in *any* longest path -- in our graph, these are edges <span class="process-math">\(A,C,D,E, G\)</span> and <span class="process-math">\(H\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-5-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-5-4">To make the whole project finish early, we need to decrease the length of *every* longest path, and so these are the edges that are included in *every* longest path. In our graph, these are edges <span class="process-math">\(A\)</span> and <span class="process-math">\(H\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-5-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subs_graphalgorithms_longest-path-algorithm-5-5">These ideas can be developed further, to list for each task the earliest possible starting time, and the latest starting time that is possible while still finishing the whole project in the minimum amount of time.<div class="autopermalink" data-description="Paragraph"><a href="#subs_graphalgorithms_longest-path-algorithm-5-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Subsubsection 3.5.2.3: Critical path analysis"><a href="#subs_graphalgorithms_longest-path-algorithm-5" title="Copy heading and permalink for Subsubsection 3.5.2.3: Critical path analysis" aria-label="Copy heading and permalink for Subsubsection 3.5.2.3: Critical path analysis">ðŸ”—</a></div></section><div class="autopermalink" data-description="Subsection 3.5.2: Longest Path Algorithm"><a href="#subs_graphalgorithms_longest-path-algorithm" title="Copy heading and permalink for Subsection 3.5.2: Longest Path Algorithm" aria-label="Copy heading and permalink for Subsection 3.5.2: Longest Path Algorithm">ðŸ”—</a></div></section><div class="autopermalink" data-description="Section 3.5: Algorithm for Longest Paths"><a href="#s_graphalgorithms_longest-paths" title="Copy heading and permalink for Section 3.5: Algorithm for Longest Paths" aria-label="Copy heading and permalink for Section 3.5: Algorithm for Longest Paths">ðŸ”—</a></div></section></div>
<div id="ptx-content-footer" class="ptx-content-footer">
<a class="previous-button button" href="s_graphalgorithms_shortest-paths.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="s_graphalgorithms_traveling-salesperson.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
